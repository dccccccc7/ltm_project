(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6db1437a"],{"0442":function(t,e,a){"use strict";var n=a("ba4a"),r=a.n(n);r.a},"1bab":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("d3b7");var n=a("bc3a"),r=a.n(n);function i(t){return new Promise((function(e,a){var n=r.a.create({timeout:3e3});n(t).then((function(t){e(t)})).catch((function(t){a(t)}))}))}},"4c49":function(t,e,a){"use strict";var n=a("8b60"),r=a.n(n);r.a},"4d63":function(t,e,a){var n=a("83ab"),r=a("da84"),i=a("94ca"),s=a("7156"),o=a("9bf2").f,l=a("241c").f,c=a("44e7"),u=a("ad6d"),d=a("9f7f"),m=a("6eeb"),p=a("d039"),f=a("69f3").set,g=a("2626"),h=a("b622"),b=h("match"),_=r.RegExp,v=_.prototype,y=/a/g,w=/a/g,D=new _(y)!==y,k=d.UNSUPPORTED_Y,C=n&&i("RegExp",!D||k||p((function(){return w[b]=!1,_(y)!=y||_(w)==w||"/a/i"!=_(y,"i")})));if(C){var S=function(t,e){var a,n=this instanceof S,r=c(t),i=void 0===e;if(!n&&r&&t.constructor===S&&i)return t;D?r&&!i&&(t=t.source):t instanceof S&&(i&&(e=u.call(t)),t=t.source),k&&(a=!!e&&e.indexOf("y")>-1,a&&(e=e.replace(/y/g,"")));var o=s(D?new _(t,e):_(t,e),n?this:v,S);return k&&a&&f(o,{sticky:a}),o},x=function(t){t in S||o(S,t,{configurable:!0,get:function(){return _[t]},set:function(e){_[t]=e}})},O=l(_),$=0;while(O.length>$)x(O[$++]);v.constructor=S,S.prototype=v,m(r,"RegExp",S)}g("RegExp")},5060:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s}));a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5319");var n=a("1bab"),r=a("4360");function i(t,e){if(e.data instanceof Object){var a=r["a"].getters.userinfo;delete a.accessList,console.log(a),e.data.user=r["a"].getters.userinfo}return e.timeout=e.timeout?e.timeout:2500,new Promise((function(a,r){Object(n["a"])(e).then((function(e){var n=e.data.code;if(200===n)a(e);else if(-1===n){var i=e.data.message;t.$message.error(i)}else 100===n&&r(e)})).catch((function(e){t.$message.error("服务器开小差了!")}))}))}function s(t){if(!t)return"";var e=new Date(t);return e.format("yyyy-MM-dd")}Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t}},7156:function(t,e,a){var n=a("861d"),r=a("d2bb");t.exports=function(t,e,a){var i,s;return r&&"function"==typeof(i=e.constructor)&&i!==a&&n(s=i.prototype)&&s!==a.prototype&&r(t,s),t}},7364:function(t,e,a){},"8b60":function(t,e,a){},a752:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"DepartmentManagement",attrs:{id:"DepartmentManagement"}},[a("div",{attrs:{id:"TableHeader"}},[a("el-button",{attrs:{size:"small"},on:{click:t.clearFilter}},[t._v("清除所有过滤器")]),a("el-button",{attrs:{size:"small"},on:{click:t.handleCreate}},[t._v("+新建部门")]),a("el-button",{attrs:{size:"small",type:this.multipleSelection.length>0?"danger":""},on:{click:function(e){return t.handleDelete()}}},[t._v("删除部门 ")]),a("div",{staticStyle:{margin:"auto"}}),a("div",{attrs:{id:"FilterBar"}},[a("div",{staticClass:"filter-bar-item"},[a("span",{staticStyle:{"margin-right":"5px"}},[t._v("部门名")]),a("el-input",{attrs:{placeholder:"查询部门名",size:"small"},model:{value:t.filter_department_name,callback:function(e){t.filter_department_name=e},expression:"filter_department_name"}})],1),a("el-button",{attrs:{size:"small"},on:{click:t.getData}},[t._v("查询")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"elementTable",staticClass:"elementTable",attrs:{stripe:"",fit:"",height:670,"default-sort":{prop:"id",order:"ascending"},data:t.tableData},on:{"sort-change":t.sortChange,"filter-change":t.filterChange,"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{width:"60",type:"index"}}),a("el-table-column",{attrs:{width:"100","column-key":"department_name",prop:"department_name",sortable:"custom",label:"部门名"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.department_name))])]}}])}),a("el-table-column",{attrs:{prop:"manager_id",width:"130",sortable:"custom","column-key":"manager_id",label:"负责人id"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.manager_id))])]}}])}),a("el-table-column",{attrs:{width:"130","column-key":"manager_name",prop:"manager_name",sortable:"custom",label:"负责人姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.manager_name))])]}}])}),a("el-table-column",{attrs:{width:"130","column-key":"departmentCount",prop:"departmentCount",label:"部门人数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.departmentCount[e.row.department_name]))])]}}])}),a("el-table-column",{attrs:{prop:"department_describe","min-width":"100","column-key":"department_describe",label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.department_describe))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.handleEdit(e.$index,e.row)}}},[t._v(" 修改 ")])]}}])})],1),a("el-pagination",{attrs:{id:"TablePagination",background:"",layout:"total,prev, pager, next,jumper,sizes",total:t.totalNum,"page-size":t.pageSize,"page-sizes":[15,30,50,100,99999],"current-page":t.pageNum},on:{"current-change":t.pageChange,"size-change":t.sizeChange,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}}),a("DepartmentEditPanel",{attrs:{"current-obj":t.currentObj,"dialog-visible":t.dialogVisible,"is-id-editable":t.isIdEditable,mode:t.mode},on:{close:t.closeDialog}})],1)},r=[],i=(a("d3b7"),a("5060")),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"editpanel"}},[a("el-dialog",{attrs:{title:"编辑信息",width:"40%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"elementForm",attrs:{model:t.currentObj,rules:t.rules}},[a("el-form-item",{staticClass:"item",attrs:{label:"部门名","label-width":"100px",prop:"department_name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.currentObj.department_name,callback:function(e){t.$set(t.currentObj,"department_name",e)},expression:"currentObj.department_name"}})],1),a("el-form-item",{staticClass:"item",attrs:{label:"负责人id","label-width":"100px",prop:"manager_id"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.currentObj.manager_id,callback:function(e){t.$set(t.currentObj,"manager_id",t._n(e))},expression:"currentObj.manager_id"}})],1),a("el-form-item",{staticClass:"item",attrs:{label:"负责人姓名","label-width":"100px",prop:"manager_name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.currentObj.manager_name,callback:function(e){t.$set(t.currentObj,"manager_name",e)},expression:"currentObj.manager_name"}})],1),a("el-form-item",{staticClass:"item",attrs:{label:"描述","label-width":"100px",prop:"role_describe"}},[a("el-input",{staticStyle:{width:"500px"},attrs:{autocomplete:"off"},model:{value:t.currentObj.department_describe,callback:function(e){t.$set(t.currentObj,"department_describe",e)},expression:"currentObj.department_describe"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.dialogCancel}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.dialogConfirm}},[t._v("确 定")])],1)],1)],1)},o=[],l={name:"DepartmentEditPanel",data:function(){return{loading:!1,rules:{manager_name:[{required:!0,message:"请输入负责人姓名",trigger:"blur"}],manager_id:[{required:!0,message:"请输入负责人id",trigger:"blur"},{type:"number",message:"负责人id必须是数字",trigger:"blur"}],department_name:[{required:!0,message:"请输入部门名",trigger:"blur"}]}}},props:{dialogVisible:!1,currentObj:{},isIdEditable:!1,mode:String},methods:{dialogConfirm:function(){var t=this,e=this.currentObj;e.request=this.mode,e.department_describe=e.department_describe?e.department_describe:"",this.$refs["elementForm"].validate((function(a){if(!a)return t.$message.error("错误提交"),!1;Object(i["a"])(t,{url:"data/departmentManagement/departmentUpdate",method:"post",data:e}).then((function(e){t.$message.success("操作成功！")})).finally((function(){t.$emit("close")}))}))},dialogCancel:function(){this.$emit("close")}}},c=l,u=(a("4c49"),a("2877")),d=Object(u["a"])(c,s,o,!1,null,"22cb5b04",null),m=d.exports,p=a("1bab"),f=a("f751"),g={name:"DepartmentManagement",components:{DepartmentChangeManagement:f["a"],DepartmentEditPanel:m},data:function(){return{tableData:[],pageSize:30,pageNum:1,totalNum:50,loading:!1,mode:"update",departmentCount:{},statusCount:0,currentTime:new Date,currentObj:{},dialogVisible:!1,isIdEditable:!0,multipleSelection:[],filter_department_name:"",sort:"department_name",sortMethod:"asc"}},created:function(){this.getData()},methods:{getCount:function(){var t=this;Object(p["a"])({url:"data/applyManagement/toBeAddress",method:"post"}).then((function(e){t.statusCount=e.data}))},getData:function(){var t=this;this.loading=!0;var e={filter_role_name:this.filter_department_name};return e.pageSize=this.pageSize,e.pageNum=this.pageNum,e.sort=this.sort,e.sortMethod=this.sortMethod,this.getCount(),Object(i["a"])(this,{url:"data/departmentManagement/departmentList",method:"post",data:e}).then((function(e){console.log(e.data);var a=e.data,n=a.total,r=a.departmentList,i=a.departmentCount;t.tableData=r;for(var s={},o=0;o<i.length;o++)s[i[o].department]=i[o]["count"];t.departmentCount=s,t.totalNum=n})).finally((function(){t.loading=!1}))},formatter:function(t){return Object(i["b"])(t)},clearFilter:function(){this.filter_department_name="",this.sort="department_name",this.sortMethod="asc",this.$refs.elementTable.clearFilter(),this.getData()},sortChange:function(t){var e=t.column,a=t.prop,n=t.order;this.sort=a,this.sortMethod="descending"===n?"desc":"asc",console.log(e,a,n),this.getData()},filterChange:function(t){t.role_name&&(this.filter_department_name=t.role_name),this.getData()},pageChange:function(t){this.pageNum=t,this.getData()},sizeChange:function(t){this.pageSize=t,this.pageNum=1,this.getData()},selectionChange:function(t){this.multipleSelection=t},handleDelete:function(){var t=this,e=this.multipleSelection;if(0!==e.length){for(var a=0;a<e.length;a++){var n=e[a].department_name;if(this.departmentCount[n]>0)return void this.$message.info("不能删除仍有人员的部门")}var r=e.length;this.$confirm("确定删除选择的".concat(r,"个部门？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Object(i["a"])(t,{url:"data/departmentManagement/departmentDelete",method:"post",data:{departmentList:t.multipleSelection}}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.multipleSelection=[],t.getData()})).finally((function(){t.loading=!1}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}else this.$message.info("未选择任何部门")},handleEdit:function(t,e){this.currentObj=e,this.isIdEditable=!1,this.dialogVisible=!0,this.mode="update"},closeDialog:function(){this.currentObj={},this.dialogVisible=!1,this.getData()},handleCreate:function(){this.currentObj={},this.isIdEditable=!0,this.mode="insert",this.dialogVisible=!0}},activated:function(){var t=this;this.getData(),this.currentTime=new Date,this.$nextTick((function(){t.$refs.elementTable.doLayout()}))}},h=g,b=(a("c467"),Object(u["a"])(h,n,r,!1,null,"7edccbd2",null));e["default"]=b.exports},ba4a:function(t,e,a){},c467:function(t,e,a){"use strict";var n=a("7364"),r=a.n(n);r.a},f751:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"DepartmentChangeManagement",attrs:{id:"DepartmentChangeManagement"}},[a("div",{attrs:{id:"TableHeader"}},[a("el-button",{attrs:{size:"small"},on:{click:t.clearFilter}},[t._v("清除所有过滤器")]),a("el-button",{attrs:{size:"small",type:this.multipleSelection.length>0?"danger":""},on:{click:function(e){return t.batchHandle()}}},[t._v("批量审核 ")]),a("div",{staticStyle:{margin:"auto"}}),a("div",{attrs:{id:"FilterBar"}},[a("div",{staticClass:"filter-bar-item"},[a("span",{staticStyle:{"margin-right":"5px"}},[t._v("申请人")]),a("el-input",{attrs:{placeholder:"查询申请人id",size:"small"},model:{value:t.filter_transfer_id,callback:function(e){t.filter_transfer_id=t._n(e)},expression:"filter_transfer_id"}})],1),a("el-button",{attrs:{size:"small"},on:{click:t.getData}},[t._v("查询")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"elementTable2",staticClass:"elementTable",attrs:{stripe:"",fit:"",height:670,"default-sort":{prop:"id",order:"ascending"},data:t.tableData},on:{"sort-change":t.sortChange,"filter-change":t.filterChange,"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:t.checkSelectable,width:"55"}}),a("el-table-column",{attrs:{width:"60",type:"index"}}),a("el-table-column",{attrs:{"min-width":"60","column-key":"transfer_id",prop:"transfer_id",sortable:"custom",label:"申请人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.transfer_id))])]}}])}),a("el-table-column",{attrs:{prop:"from_department","min-width":"60","column-key":"from_department",label:"原部门"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.from_department))])]}}])}),a("el-table-column",{attrs:{prop:"to_department","min-width":"60","column-key":"to_department",label:"新部门"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.to_department))])]}}])}),a("el-table-column",{attrs:{prop:"status",width:"100","column-key":"status",sortable:"custom",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.tagColor(e.row.status),"disable-transitions":""}},[t._v(t._s(e.row.status)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"created_by","column-key":"created_by",sortable:"custom",label:"操作人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.created_by))])]}}])}),a("el-table-column",{attrs:{prop:"created_time","column-key":"created_time",sortable:"custom",label:"操作时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatter(e.row.created_time)))])]}}])}),a("el-table-column",{attrs:{prop:"handled_by","column-key":"handled_by",sortable:"custom",label:"处理人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.handled_by))])]}}])}),a("el-table-column",{attrs:{prop:"handled_time","column-key":"handled_time",sortable:"custom",label:"处理时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatter(e.row.handled_time)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"flex"}},[a("el-button",{attrs:{disabled:"待审核"!==e.row.status,type:"success",size:"mini"},nativeOn:{click:function(a){return a.preventDefault(),t.handleAgree(e.$index,e.row)}}},[t._v(" 同意 ")]),a("el-button",{attrs:{disabled:"待审核"!==e.row.status,type:"danger",size:"mini"},nativeOn:{click:function(a){return a.preventDefault(),t.handleDecline(e.$index,e.row)}}},[t._v(" 拒绝 ")])],1)]}}])})],1),a("el-pagination",{attrs:{id:"TablePagination",background:"",layout:"total,prev, pager, next,jumper,sizes",total:t.totalNum,"page-size":t.pageSize,"page-sizes":[15,30,50,100,99999],"current-page":t.pageNum},on:{"current-change":t.pageChange,"size-change":t.sizeChange,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1)},r=[],i=(a("d3b7"),a("5060")),s={name:"DepartmentChangeManagement",components:{},data:function(){return{tableData:[],pageSize:30,pageNum:1,totalNum:50,loading:!1,mode:"update",multipleSelection:[],filter_transfer_id:"",sort:"created_time",sortMethod:"asc"}},created:function(){this.getData()},props:{tableDoLayout:Date},methods:{getData:function(){var t=this;this.$emit("getCount"),this.loading=!0;var e={filter_transfer_id:this.filter_transfer_id?this.filter_transfer_id:0,filter_created_by:"",status:[]};return e.pageSize=this.pageSize,e.pageNum=this.pageNum,e.sort=this.sort,e.sortMethod=this.sortMethod,Object(i["a"])(this,{url:"data/applyManagement/applyList",method:"post",data:e}).then((function(e){console.log(e.data);var a=e.data,n=a.total,r=a.applyList;t.tableData=r,t.totalNum=n})).finally((function(){t.loading=!1}))},formatter:function(t){return Object(i["b"])(t)},checkSelectable:function(t,e){return"待审核"===t.status},clearFilter:function(){this.filter_transfer_id=0,this.sort="created_time",this.sortMethod="asc",this.$refs.elementTable2.clearFilter(),this.getData()},sortChange:function(t){var e=t.column,a=t.prop,n=t.order;this.sort=a,this.sortMethod="descending"===n?"desc":"asc",console.log(e,a,n),this.getData()},filterChange:function(t){this.getData()},pageChange:function(t){this.pageNum=t,this.getData()},sizeChange:function(t){this.pageSize=t,this.pageNum=1,this.getData()},selectionChange:function(t){this.multipleSelection=t},batchHandle:function(){var t=this,e=this.multipleSelection;if(0!==e.length){var a=e.length;this.$confirm("确定审核选择的".concat(a,"个申请？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=0;t.$confirm("是否同意申请？","提示",{confirmButtonText:"同意",cancelButtonText:"拒绝",type:"warning"}).then((function(){return a=1})).catch((function(){return a=0})).finally((function(){t.loading=!0;for(var n=[],r=0;r<e.length;r++)n.push({handled_id:123456789,apply_id:e[r].log_id,isAccept:a,user:t.$store.getters.userinfo});Object(i["a"])(t,{url:"data/applyManagement/applyAddress",method:"post",data:n}).catch((function(e){t.$message({type:"success",message:"操作成功!"}),t.multipleSelection=[],t.getData()}))})).finally((function(){t.loading=!1}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}else this.$message.info("未选择任何申请")},handleAgree:function(t,e){this.currentObj=e,this.applyRequest(e.log_id,1)},handleDecline:function(t,e){this.currentObj=e,this.applyRequest(e.log_id,0)},applyRequest:function(t,e){var a=this;return Object(i["a"])(this,{url:"data/applyManagement/applySingleAddress",method:"post",data:{handled_id:123456789,apply_id:t,isAccept:e}}).then((function(t){})).catch((function(t){a.$message.success("操作成功"),a.getData()}))}},computed:{tagColor:function(){return function(t){return"同意"===t?"success":"拒绝"===t?"danger":"primary"}}},watch:{tableDoLayout:function(t){this.getData(),this.$refs.elementTable2.doLayout()}},activated:function(){this.getData(),this.$refs.elementTable2.doLayout()}},o=s,l=(a("0442"),a("2877")),c=Object(l["a"])(o,n,r,!1,null,"7a0d7c0c",null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-6db1437a.c0d0a5d3.js.map
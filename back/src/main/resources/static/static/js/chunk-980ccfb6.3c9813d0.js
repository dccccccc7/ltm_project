(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-980ccfb6"],{"1bab":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("d3b7");var a=r("bc3a"),n=r.n(a);function i(e){return new Promise((function(t,r){var a=n.a.create({timeout:3e3});a(e).then((function(e){t(e)})).catch((function(e){r(e)}))}))}},"47db":function(e,t,r){},"4d63":function(e,t,r){var a=r("83ab"),n=r("da84"),i=r("94ca"),l=r("7156"),s=r("9bf2").f,o=r("241c").f,u=r("44e7"),c=r("ad6d"),d=r("9f7f"),m=r("6eeb"),f=r("d039"),p=r("69f3").set,g=r("2626"),b=r("b622"),h=b("match"),_=n.RegExp,v=_.prototype,y=/a/g,x=/a/g,w=new _(y)!==y,O=d.UNSUPPORTED_Y,k=a&&i("RegExp",!w||O||f((function(){return x[h]=!1,_(y)!=y||_(x)==x||"/a/i"!=_(y,"i")})));if(k){var j=function(e,t){var r,a=this instanceof j,n=u(e),i=void 0===t;if(!a&&n&&e.constructor===j&&i)return e;w?n&&!i&&(e=e.source):e instanceof j&&(i&&(t=c.call(e)),e=e.source),O&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var s=l(w?new _(e,t):_(e,t),a?this:v,j);return O&&r&&p(s,{sticky:r}),s},E=function(e){e in j||s(j,e,{configurable:!0,get:function(){return _[e]},set:function(t){_[e]=t}})},S=o(_),C=0;while(S.length>C)E(S[C++]);v.constructor=j,j.prototype=v,m(n,"RegExp",j)}g("RegExp")},5060:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return l}));r("d3b7"),r("4d63"),r("ac1f"),r("25f0"),r("5319");var a=r("1bab"),n=r("4360");function i(e,t){if(t.data instanceof Object){var r=n["a"].getters.userinfo;delete r.accessList,console.log(r),t.data.user=n["a"].getters.userinfo}return t.timeout=t.timeout?t.timeout:2500,new Promise((function(r,n){Object(a["a"])(t).then((function(t){var a=t.data.code;if(200===a)r(t);else if(-1===a){var i=t.data.message;e.$message.error(i)}else 100===a&&n(t)})).catch((function(t){e.$message.error("服务器开小差了!")}))}))}function l(e){if(!e)return"";var t=new Date(e);return t.format("yyyy-MM-dd")}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var a=r("1d80"),n=r("5899"),i="["+n+"]",l=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),o=function(e){return function(t){var r=String(a(t));return 1&e&&(r=r.replace(l,"")),2&e&&(r=r.replace(s,"")),r}};e.exports={start:o(1),end:o(2),trim:o(3)}},"708c":function(e,t,r){"use strict";var a=r("47db"),n=r.n(a);n.a},7156:function(e,t,r){var a=r("861d"),n=r("d2bb");e.exports=function(e,t,r){var i,l;return n&&"function"==typeof(i=t.constructor)&&i!==r&&a(l=i.prototype)&&l!==r.prototype&&n(e,l),e}},a9e3:function(e,t,r){"use strict";var a=r("83ab"),n=r("da84"),i=r("94ca"),l=r("6eeb"),s=r("5135"),o=r("c6b6"),u=r("7156"),c=r("c04e"),d=r("d039"),m=r("7c73"),f=r("241c").f,p=r("06cf").f,g=r("9bf2").f,b=r("58a8").trim,h="Number",_=n[h],v=_.prototype,y=o(m(v))==h,x=function(e){var t,r,a,n,i,l,s,o,u=c(e,!1);if("string"==typeof u&&u.length>2)if(u=b(u),t=u.charCodeAt(0),43===t||45===t){if(r=u.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+u}for(i=u.slice(2),l=i.length,s=0;s<l;s++)if(o=i.charCodeAt(s),o<48||o>n)return NaN;return parseInt(i,a)}return+u};if(i(h,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var w,O=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof O&&(y?d((function(){v.valueOf.call(r)})):o(r)!=h)?u(new _(x(t)),r,O):x(t)},k=a?f(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0;k.length>j;j++)s(_,w=k[j])&&!s(O,w)&&g(O,w,p(_,w));O.prototype=v,v.constructor=O,l(n,h,O)}},d367:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"UserManagement",attrs:{id:"DepartmentManagement"}},[r("div",{attrs:{id:"TableHeader"}},[r("el-button",{attrs:{size:"small"},on:{click:e.clearFilter}},[e._v("清除所有过滤器")]),r("el-button",{attrs:{size:"small"},on:{click:e.handleCreate}},[e._v("+新建用户")]),r("el-button",{attrs:{size:"small",type:this.multipleSelection.length>0?"danger":""},on:{click:function(t){return e.handleDelete()}}},[e._v("删除用户 ")]),r("div",{staticStyle:{margin:"auto"}}),r("div",{attrs:{id:"FilterBar"}},[r("div",{staticClass:"filter-bar-item"},[r("span",{staticStyle:{"margin-right":"5px"}},[e._v("id")]),r("el-input",{attrs:{type:"number",placeholder:"查询id",size:"small"},model:{value:e.filter_id,callback:function(t){e.filter_id=t},expression:"filter_id"}})],1),r("div",{staticClass:"filter-bar-item"},[r("span",{staticStyle:{"margin-right":"5px"}},[e._v("用户名")]),r("el-input",{attrs:{placeholder:"查询用户名",size:"small"},model:{value:e.filter_name,callback:function(t){e.filter_name=t},expression:"filter_name"}})],1),r("div",{staticClass:"filter-bar-item"},[r("span",{staticStyle:{"margin-right":"5px"}},[e._v("账号")]),r("el-input",{attrs:{placeholder:"查询账号",size:"small"},model:{value:e.filter_user_name,callback:function(t){e.filter_user_name=t},expression:"filter_user_name"}},[e._v(" >")])],1),r("el-button",{attrs:{size:"small"},on:{click:e.getData}},[e._v("查询")])],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"elementTable",staticClass:"elementTable",attrs:{stripe:"",fit:"",height:710,"default-sort":{prop:"id",order:"ascending"},data:e.tableData},on:{"sort-change":e.sortChange,"filter-change":e.filterChange,"selection-change":e.selectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{width:"60",type:"index"}}),r("el-table-column",{attrs:{prop:"id",width:"100",sortable:"custom","column-key":"id",label:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.id))])]}}])}),r("el-table-column",{attrs:{"min-width":"45","column-key":"name",prop:"name",label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.name))])]}}])}),r("el-table-column",{attrs:{prop:"sex","min-width":"30","column-key":"sex",sortable:"custom",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(0===t.row.sex?"女":"男"))])]}}])}),r("el-table-column",{attrs:{prop:"age","column-key":"age",sortable:"custom","min-width":"35",label:"年龄"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.age))])]}}])}),r("el-table-column",{attrs:{"column-key":"user_name",sortable:"custom",prop:"user_name",label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.user_name))])]}}])}),r("el-table-column",{attrs:{prop:"department","column-key":"department",sortable:"custom",filters:this.departmentList,label:"部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.department))])]}}])}),r("el-table-column",{attrs:{prop:"role","column-key":"role",sortable:"custom",filters:this.roleList,label:"职位"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.role))])]}}])}),r("el-table-column",{attrs:{prop:"created_time","column-key":"created_time",sortable:"custom",label:"创建日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.formatter(t.row.created_time)))])]}}])}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){return r.preventDefault(),e.handleEdit(t.$index,t.row)}}},[e._v(" 修改 ")])]}}])})],1),r("el-pagination",{attrs:{id:"TablePagination",background:"",layout:"total,prev, pager, next,jumper,sizes",total:e.totalNum,"page-size":e.pageSize,"page-sizes":[15,30,50,100,99999],"current-page":e.pageNum},on:{"current-change":e.pageChange,"size-change":e.sizeChange,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}),r("UserEditPanel",{attrs:{"current-obj":e.currentObj,mode:e.mode,"role-list":e.roleList,"department-list":e.departmentList,"dialog-visible":e.dialogVisible,"is-id-editable":e.isIdEditable},on:{close:e.closeDialog}})],1)},n=[],i=(r("a9e3"),r("d3b7"),r("5060")),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"editpanel"}},[r("el-dialog",{attrs:{title:"编辑信息",width:"40%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"elementForm",attrs:{model:e.currentObj,rules:e.rules}},[r("el-form-item",{staticClass:"item",attrs:{label:"id","label-width":"100px",prop:"id"}},[r("el-input",{attrs:{autocomplete:"off",disabled:!e.isIdEditable},model:{value:e.currentObj.id,callback:function(t){e.$set(e.currentObj,"id",e._n(t))},expression:"currentObj.id"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"用户名","label-width":"100px",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentObj.name,callback:function(t){e.$set(e.currentObj,"name",t)},expression:"currentObj.name"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"性别","label-width":"100px",prop:"sex"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.currentObj.sex,callback:function(t){e.$set(e.currentObj,"sex",t)},expression:"currentObj.sex"}},[r("el-option",{attrs:{label:"男",value:1}}),r("el-option",{attrs:{label:"女",value:0}})],1)],1),r("el-form-item",{staticClass:"item",attrs:{label:"年龄","label-width":"100px",prop:"age"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentObj.age,callback:function(t){e.$set(e.currentObj,"age",e._n(t))},expression:"currentObj.age"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"账号","label-width":"100px",prop:"user_name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentObj.user_name,callback:function(t){e.$set(e.currentObj,"user_name",t)},expression:"currentObj.user_name"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"密码","label-width":"100px",prop:"pwd"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentObj.pwd,callback:function(t){e.$set(e.currentObj,"pwd",t)},expression:"currentObj.pwd"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"部门","label-width":"100px",prop:"department"}},[r("el-select",{model:{value:e.currentObj.department,callback:function(t){e.$set(e.currentObj,"department",t)},expression:"currentObj.department"}},e._l(e.departmentList.map((function(e){return e.value})),(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{staticClass:"item",attrs:{label:"职位","label-width":"100px",prop:"role"}},[r("el-select",{model:{value:e.currentObj.role,callback:function(t){e.$set(e.currentObj,"role",t)},expression:"currentObj.role"}},e._l(e.roleList.map((function(e){return e.value})),(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.dialogCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.dialogConfirm}},[e._v("确 定")])],1)],1)],1)},s=[],o={name:"EditPanel",data:function(){return{loading:!1,department_options:[],role_options:[],originDepartment:"",rules:{id:[{required:!0,message:"请输入id",trigger:"blur"},{type:"number",message:"id必须为数字",trigger:"blur"}],name:[{required:!0,message:"请输入用户名",trigger:"blur"},{max:4,message:"用户名过长",trigger:"blur"}],user_name:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],department:[{required:!0,message:"请选择部门",trigger:"blur"}],role:[{required:!0,message:"请选择职位",trigger:"blur"}],age:[{required:!0,message:"请填写年龄",trigger:"blur"},{type:"number",min:0,max:120,message:"年龄必须是合法整数",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]}}},props:{dialogVisible:!1,currentObj:{},isIdEditable:!1,roleList:Array,departmentList:Array,mode:String},methods:{dialogConfirm:function(){var e=this,t=this.currentObj;t.request=this.mode,t.isChangeDepartment=this.currentObj.department===this.originDepartment?0:1,this.$refs["elementForm"].validate((function(r){if(!r)return e.$message.error("错误提交"),!1;Object(i["a"])(e,{url:"data/systemManagement/userUpdate",method:"post",data:t}).then((function(t){e.$message.success("操作成功！")})).catch((function(t){e.$message.info("已提出部门变更申请！")})).finally((function(){e.$emit("close")}))}))},dialogCancel:function(){this.$emit("close")}},watch:{currentObj:function(e){e.department&&(this.$message.info(e.department),this.originDepartment=e.department)}}},u=o,c=(r("d7c1"),r("2877")),d=Object(c["a"])(u,l,s,!1,null,"30755e8e",null),m=d.exports,f={name:"UserManagement",components:{UserEditPanel:m},data:function(){return{tableData:[],roleList:[],departmentList:[],pageSize:30,pageNum:1,totalNum:50,loading:!1,currentObj:{},dialogVisible:!1,isIdEditable:!0,mode:"update",multipleSelection:[],filter_id:"",filter_department:[],filter_role:[],filter_name:"",filter_user_name:"",sort:"id",sortMethod:"asc"}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.loading=!0;var t={filter_name:this.filter_name,filter_id:this.filter_id?Number(this.filter_id):0,filter_department:this.filter_department,filter_role:this.filter_role,filter_user_name:this.filter_user_name};return t.pageSize=this.pageSize,t.pageNum=this.pageNum,t.sort=this.sort,t.sortMethod=this.sortMethod,Object(i["a"])(this,{url:"data/systemManagement/userList",method:"post",data:t}).then((function(t){console.log(t.data);var r=t.data,a=r.total,n=r.userList,i=r.roleList,l=r.departmentList;e.tableData=n,e.roleList=[],e.departmentList=[];for(var s=0;s<i.length;s++)e.roleList.push({text:i[s],value:i[s]});for(var o=0;o<l.length;o++)e.departmentList.push({text:l[o],value:l[o]});e.totalNum=a})).finally((function(){e.loading=!1}))},formatter:function(e){return Object(i["b"])(e)},clearFilter:function(){this.filter_name="",this.filter_id="",this.filter_role=[],this.filter_department=[],this.filter_user_name="",this.sort="id",this.sortMethod="asc",this.$refs.elementTable.clearFilter(),this.getData()},sortChange:function(e){var t=e.column,r=e.prop,a=e.order;this.sort=r,this.sortMethod="descending"===a?"desc":"asc",console.log(t,r,a),this.getData()},filterChange:function(e){e.role&&(this.filter_role=e.role),e.department&&(this.filter_department=e.department),this.getData()},pageChange:function(e){this.pageNum=e,this.getData()},sizeChange:function(e){this.pageSize=e,this.pageNum=1,this.getData()},selectionChange:function(e){this.multipleSelection=e},handleDelete:function(){var e=this,t=this.multipleSelection;if(0!==t.length){var r=t.length;this.$confirm("确定删除选择的".concat(r,"个用户？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0;var t=120*e.multipleSelection.length;e.multipleSelection.length>=25&&e.$message({type:"info",message:"执行时间约为".concat(t/1e3,"秒，请等待！")}),Object(i["a"])(e,{url:"data/systemManagement/userDelete",method:"post",timeout:t>2500?t:2500,data:{userList:e.multipleSelection}}).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.multipleSelection=[],e.getData()})).finally((function(){e.loading=!1}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}else this.$message.info("未选择任何用户")},handleEdit:function(e,t){this.mode="update",this.currentObj=t,this.isIdEditable=!1,this.dialogVisible=!0},closeDialog:function(){this.currentObj={},this.dialogVisible=!1,this.getData()},handleCreate:function(){this.mode="insert",this.currentObj={},this.isIdEditable=!0,this.dialogVisible=!0}},activated:function(){var e=this;this.$nextTick((function(){e.$refs.elementTable.doLayout()}))}},p=f,g=(r("708c"),Object(c["a"])(p,a,n,!1,null,"75e4acce",null));t["default"]=g.exports},d7c1:function(e,t,r){"use strict";var a=r("f697"),n=r.n(a);n.a},f697:function(e,t,r){}}]);
//# sourceMappingURL=chunk-980ccfb6.3c9813d0.js.map
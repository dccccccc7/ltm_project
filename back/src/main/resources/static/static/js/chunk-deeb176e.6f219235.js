(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-deeb176e"],{"08a7":function(t,e,i){"use strict";var r=i("2d0c"),a=i.n(r);a.a},"2d0c":function(t,e,i){},"467e":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"detail-base"}},[i("div",{attrs:{id:"detail-product"}},[i("h2",[t._v("产品信息")]),i("el-card",[i("div",[t._v("产品id："+t._s(t.product_id))]),i("div",[t._v("品牌："+t._s(t.product.brand))]),i("div",[t._v("季节："+t._s(t.product.season))]),i("div",[t._v("产品类别："+t._s(t.product.type))]),i("div",[t._v("客户款号："+t._s(t.product.customer_id))]),i("div",[t._v("公司款号："+t._s(t.product.company_id))]),i("div",[t._v("颜色："+t._s(t.product.color))]),i("div",[t._v("描述："+t._s(t.product.comments))])])],1),i("div",{attrs:{id:"detail-process"}},[i("h2",[t._v("工艺流程")]),i("el-card",[t._v("描述："+t._s(t.process.comments))]),i("el-card",[t._v("成本："+t._s(t.process.cost))]),t._l(t.process.data,(function(e,r){return i("el-card",[i("div",{staticStyle:{"font-weight":"bold"}},[t._v("步骤"+t._s(r+1)+"：")]),i("div",[t._v("工序id："+t._s(e.procedure_id))]),i("div",[t._v("名称："+t._s(e.name))]),i("div",[t._v("描述："+t._s(e.comments))])])}))],2),i("div",{attrs:{id:"detail-material"}},[i("h2",[t._v("物料清单")]),t._l(t.material,(function(e,r){return i("el-card",[i("div",{staticStyle:{"font-weight":"bold"}},[t._v("物料"+t._s(r+1)+"：")]),i("div",[t._v("物料id："+t._s(e.material_id))]),i("div",[t._v("名称："+t._s(e.name))]),i("div",[t._v("规格："+t._s(e.size))]),i("div",[t._v("颜色："+t._s(e.color))]),i("div",[t._v("数量："+t._s(e.count))]),i("div",[t._v("描述："+t._s(e.comments))])])}))],2)])},a=[],o=i("1bab"),s={name:"detail",props:["product_id"],data:function(){return{product:{},process:{},material:[]}},methods:{getData:function(){var t=this;Object(o["a"])({url:"/process/getInfosByID",method:"get",params:{product_id:this.product_id}}).then((function(e){t.product=e.data.product,t.process=e.data.process,t.material=e.data.material})).catch((function(t){console.log(t)}))}},created:function(){this.getData()}},n=s,c=(i("d5bd"),i("2877")),l=Object(c["a"])(n,r,a,!1,null,"0264cef6",null);e["default"]=l.exports},be8e:function(t,e,i){"use strict";var r=i("d0ae"),a=i.n(r);a.a},c2f2:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"list-base"}},[i("div",{attrs:{id:"list-main"}},[i("el-table",{attrs:{data:t.products,border:""}},[i("el-table-column",{attrs:{prop:"product_id",label:"id",width:"180",align:"center","show-overflow-tooltip":!0}}),i("el-table-column",{attrs:{prop:"brand",label:"品牌",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"season",label:"季节",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"type",label:"产品类别",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"customer_id",label:"客户款号",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"company_id",label:"公司款号",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"color",label:"颜色",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"comments",label:"产品描述",width:"180",align:"center","show-overflow-tooltip":!0}}),i("el-table-column",{attrs:{label:"操作",id:"tool",width:"190",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",circle:"",size:"mini",icon:"el-icon-more"},on:{click:function(i){return t.showDetail(e.row)}}}),i("el-button",{attrs:{type:"primary",circle:"",size:"mini",icon:"el-icon-edit"},on:{click:function(i){return t.showEdit(e.row)}}}),i("el-button",{attrs:{type:"danger",circle:"",size:"mini",icon:"el-icon-delete"},on:{click:function(i){return t.del(e.$index,e.row)}}})]}}])})],1)],1),i("div",{attrs:{id:"list-page"}},[i("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10,15],"page-size":t.size,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),i("el-drawer",{attrs:{title:"详情",visible:t.isShowDetail,size:"40%","destroy-on-close":!0},on:{"update:visible":function(e){t.isShowDetail=e}}},[i("detail-page",{attrs:{product_id:t.product_id}})],1),i("el-drawer",{ref:"detailDrawer",attrs:{title:"编辑",visible:t.isShowEdit,size:"40%","destroy-on-close":!0,"before-close":t.handleClose},on:{"update:visible":function(e){t.isShowEdit=e}}},[i("edit-page",{attrs:{product_id:t.product_id,detailDrawer:t.$refs.detailDrawer,changeCommit:t.changeCommit}})],1),i("div",{attrs:{id:"list-bottom"}})],1)},a=[],o=i("1bab"),s=i("467e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{ref:"editForm",attrs:{id:"edit-base","label-width":"70px",model:t.edit}},[i("div",{attrs:{id:"edit-product"}},[i("h2",[t._v("产品信息")]),i("el-card",[i("el-form-item",{attrs:{label:"状态",prop:"product.status",rules:{required:!0,message:"请填写产品状态",trigger:"blur"}}},[i("el-input",{attrs:{placeholder:"请输入产品状态",maxlength:"5","show-word-limit":""},model:{value:t.edit.product.status,callback:function(e){t.$set(t.edit.product,"status",e)},expression:"edit.product.status"}})],1),i("el-form-item",{attrs:{label:"产品id"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.product_id,callback:function(e){t.$set(t.edit.product,"product_id",e)},expression:"edit.product.product_id"}})],1),i("el-form-item",{attrs:{label:"品牌"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.brand,callback:function(e){t.$set(t.edit.product,"brand",e)},expression:"edit.product.brand"}})],1),i("el-form-item",{attrs:{label:"季节"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.season,callback:function(e){t.$set(t.edit.product,"season",e)},expression:"edit.product.season"}})],1),i("el-form-item",{attrs:{label:"产品类别"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.type,callback:function(e){t.$set(t.edit.product,"type",e)},expression:"edit.product.type"}})],1),i("el-form-item",{attrs:{label:"客户款号"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.customer_id,callback:function(e){t.$set(t.edit.product,"customer_id",e)},expression:"edit.product.customer_id"}})],1),i("el-form-item",{attrs:{label:"公司款号"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.company_id,callback:function(e){t.$set(t.edit.product,"company_id",e)},expression:"edit.product.company_id"}})],1),i("el-form-item",{attrs:{label:"颜色",prop:"color"}},[i("el-input",{attrs:{disabled:!0},model:{value:t.edit.product.color,callback:function(e){t.$set(t.edit.product,"color",e)},expression:"edit.product.color"}})],1),i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入产品描述",maxlength:"45","show-word-limit":""},model:{value:t.edit.product.comments,callback:function(e){t.$set(t.edit.product,"comments",e)},expression:"edit.product.comments"}})],1)],1)],1),i("div",{attrs:{id:"edit-process"}},[i("h2",[t._v("工艺流程")]),i("el-card",[i("el-form-item",{attrs:{label:"状态",prop:"process.status",rules:{required:!0,message:"请填写工艺状态",trigger:"blur"}}},[i("el-input",{attrs:{placeholder:"请输入工艺状态",maxlength:"5","show-word-limit":""},model:{value:t.edit.process.status,callback:function(e){t.$set(t.edit.process,"status",e)},expression:"edit.process.status"}})],1),i("el-form-item",{attrs:{label:"描述",prop:t.edit.process.comments,rules:{required:!0,message:"请填写工艺描述",trigger:"blur"}}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入工艺描述",maxlength:"45","show-word-limit":""},model:{value:t.edit.process.comments,callback:function(e){t.$set(t.edit.process,"comments",e)},expression:"edit.process.comments"}})],1),i("draggable",{attrs:{forceFallback:"true",animation:"1000"},model:{value:t.edit.process.data,callback:function(e){t.$set(t.edit.process,"data",e)},expression:"edit.process.data"}},[i("transition-group",t._l(t.edit.process.data,(function(e,r){return i("el-form-item",{key:e.procedure_id,attrs:{label:"步骤"+(r+1),prop:"process.data."+r+".name",rules:{required:!0,message:"请选择步骤",trigger:"change"}}},[i("el-select",{attrs:{placeholder:"请选择工序",filterable:""},model:{value:t.edit.process.data[r].name,callback:function(e){t.$set(t.edit.process.data[r],"name",e)},expression:"edit.process.data[index].name"}},t._l(t.process_options,(function(t){return i("el-option",{attrs:{label:t,value:t}})})),1),i("el-button",{staticStyle:{color:"red","margin-left":"20px"},attrs:{size:"mini"},on:{click:function(e){return t.delProcess(r)}}},[t._v("删除")])],1)})),1)],1),i("el-form-item",[i("el-button",{on:{click:t.addProcess}},[t._v("添加")])],1)],1)],1),i("div",{attrs:{id:"edit-material"}},[i("h2",[t._v("物料清单")]),i("el-card",[t._l(t.edit.material,(function(e,r){return i("div",{staticStyle:{display:"flex","flex-direction":"row"}},[i("el-form-item",{attrs:{label:"物料"+(r+1),prop:"material."+r+".color",rules:{required:!0,message:"请选择物料",trigger:"change"}}},[i("el-cascader",{attrs:{placeholder:"请选择物料",options:t.material_options,clearable:""},on:{change:function(e){return t.setMaterial(r,e)}},model:{value:t.original_material[r],callback:function(e){t.$set(t.original_material,r,e)},expression:"original_material[index]"}})],1),i("el-form-item",{attrs:{"label-width":"0px",prop:"material."+r+".count",rules:t.numRules}},[i("el-input-number",{staticStyle:{width:"25%","margin-left":"10px"},attrs:{precision:0,controls:!1},model:{value:e.count,callback:function(i){t.$set(e,"count",i)},expression:"item.count"}}),i("el-button",{staticStyle:{color:"red","margin-left":"20px"},attrs:{size:"mini"},on:{click:function(e){return t.delMaterial(r)}}},[t._v("删除")])],1)],1)})),i("el-form-item",[i("el-button",{on:{click:t.addMaterial}},[t._v("添加")])],1)],2),i("el-form-item",[i("el-button",{on:{click:t.cancel}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.commit}},[t._v("提交")])],1)],1)])},c=[],l=(i("a434"),i("b0c0"),i("a4d3"),i("e01a"),i("d28b"),i("e260"),i("d3b7"),i("3ca3"),i("ddb0"),i("06c5"));function d(t,e){var i;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=Object(l["a"])(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,n=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){n=!0,o=t},f:function(){try{s||null==i["return"]||i["return"]()}finally{if(n)throw o}}}}var u=i("b76a"),p=i.n(u),m={name:"edit",props:["product_id","detailDrawer","changeCommit"],data:function(){var t=function(t,e,i){if(!e)return i(new Error("请填写数量"));e<=0?i(new Error("数量必须大于0")):i()};return{num:0,edit:{product:{},process:{},material:[]},original_material:[],process_options:[],material_options:[],numRules:[{validator:t,trigger:"blur"}]}},methods:{getData:function(){var t=this;Object(o["a"])({url:"/process/getInfosByID",method:"get",params:{product_id:this.product_id}}).then((function(e){t.num=e.data.process.data.length,t.edit.product=e.data.product,t.edit.process=e.data.process,t.edit.material=e.data.material,t.setOriginalMaterial(e.data.material)})).catch((function(t){console.log(t)}))},getProcess:function(){var t=this;Object(o["a"])({url:"/getProcedures",method:"get"}).then((function(e){t.process_options=e.data})).catch((function(t){console.log(t)}))},getMaterial:function(){var t=this;Object(o["a"])({url:"/getOptionMaterial",method:"get"}).then((function(e){t.material_options=e.data})).catch((function(t){console.log(t)}))},addProcess:function(){this.num++,this.edit.process.data.push({procedure_id:this.num,name:""})},delProcess:function(t){this.edit.process.data.splice(t,1)},setMaterial:function(t,e){this.edit.material[t].name=e[0],this.edit.material[t].size=e[1],this.edit.material[t].color=e[2]},delMaterial:function(t){this.edit.material.splice(t,1),this.original_material.splice(t,1)},addMaterial:function(){this.edit.material.push({name:"",size:"",color:""})},setOriginalMaterial:function(t){var e,i=d(t);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=[];a.push(r.name),a.push(r.size),a.push(r.color),this.original_material.push(a)}}catch(o){i.e(o)}finally{i.f()}},commit:function(){var t=this;this.$confirm("是否提交本次修改？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$refs["editForm"].validate((function(e){return t.edit.process.data.length<1?(t.$message({type:"error",message:"步骤不能为空"}),!1):t.edit.material.length<1?(t.$message({type:"error",message:"物料不能为空"}),!1):!!e&&void Object(o["a"])({url:"/process/update",method:"post",data:{operator_id:t.$store.getters.userinfo.id,product:t.edit.product,process:t.edit.process,material:t.edit.material}}).then((function(e){"更新成功"==e.data?(t.changeCommit(),t.detailDrawer.closeDrawer(),t.$message({type:"success",message:"更新成功"})):t.$message({type:"error",message:e.data})})).catch((function(e){t.$message({type:"error",message:"网络错误，修改失败"})}))}))}))},cancel:function(){this.detailDrawer.closeDrawer()}},components:{Draggable:p.a},created:function(){this.getData(),this.getProcess(),this.getMaterial()}},h=m,f=(i("08a7"),i("2877")),g=Object(f["a"])(h,n,c,!1,null,"41454775",null),b=g.exports,v={name:"list",data:function(){return{currentPage:1,size:5,isCommit:!1,count:0,products:[],isShowDetail:!1,product_id:"",isShowEdit:!1}},methods:{handleSizeChange:function(t){this.size=t,this.getProduct(this.currentPage,t)},handleCurrentChange:function(t){this.currentPage=t,this.getProduct(t,this.size)},getProduct:function(t,e){var i=this;Object(o["a"])({url:"/process/getProducts",method:"get",params:{pageOffset:t,pageSize:e}}).then((function(t){i.count=t.data.count,i.products=t.data.products})).catch((function(t){console.log(t)}))},del:function(t,e){var i=this;this.$confirm("是否删除该产品？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["a"])({url:"/process/deleteProductByID",method:"post",data:{operator_id:"CM",product_id:e.product_id}}).then((function(t){console.log(t.data),"删除成功"==t.data?(i.getProduct(i.currentPage,i.size),i.$message({type:"success",message:"删除成功"})):i.$message({type:"error",message:"删除失败"})})).catch((function(t){i.$message({type:"error",message:"网络错误，删除失败"})}))}))},showDetail:function(t){this.product_id=t.product_id,this.isShowDetail=!0},showEdit:function(t){this.product_id=t.product_id,this.isShowEdit=!0},handleClose:function(t){this.isCommit?(this.getProduct(this.currentPage,this.size),t()):this.$confirm("关闭后会丢失本次修改，是否关闭？").then((function(){t()})).catch((function(){})),this.isCommit=!1},changeCommit:function(){this.isCommit=!0}},components:{detailPage:s["default"],editPage:b},created:function(){this.getProduct(this.currentPage,this.size)},activated:function(){this.getProduct(this.currentPage,this.size)}},_=v,w=(i("be8e"),Object(f["a"])(_,r,a,!1,null,"88839e14",null));e["default"]=w.exports},c39a:function(t,e,i){},d0ae:function(t,e,i){},d5bd:function(t,e,i){"use strict";var r=i("c39a"),a=i.n(r);a.a}}]);
//# sourceMappingURL=chunk-deeb176e.6f219235.js.map
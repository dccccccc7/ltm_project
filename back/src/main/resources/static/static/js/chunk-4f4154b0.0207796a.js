(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f4154b0"],{"0494":function(e,t,r){"use strict";var o=r("969e"),n=r.n(o);n.a},"1bab":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("d3b7");var o=r("bc3a"),n=r.n(o);function i(e){return new Promise((function(t,r){var o=n.a.create({timeout:3e3});o(e).then((function(e){t(e)})).catch((function(e){r(e)}))}))}},"1f1b":function(e,t,r){"use strict";var o=r("d21c"),n=r.n(o);n.a},"969e":function(e,t,r){},d21c:function(e,t,r){},fc4d:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"list-base"}},[r("div",{attrs:{id:"list-main"}},[r("el-table",{attrs:{data:e.procedures,border:""}},[r("el-table-column",{attrs:{prop:"procedure_id",label:"id",width:"200",align:"center","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{prop:"name",label:"名称",width:"150",align:"center"}}),r("el-table-column",{attrs:{prop:"cost",label:"成本",width:"100",align:"center"}}),r("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"}}),r("el-table-column",{attrs:{prop:"comments",label:"产品描述",width:"200",align:"center","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"操作",id:"tool",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",circle:"",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return e.showEdit(t.row)}}}),r("el-button",{attrs:{type:"danger",circle:"",size:"mini",icon:"el-icon-delete"},on:{click:function(r){return e.del(t.$index,t.row)}}})]}}])})],1)],1),r("div",{attrs:{id:"list-page"}},[r("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.size,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),r("el-drawer",{ref:"detailDrawer",attrs:{title:"编辑",visible:e.isShowEdit,size:"40%","destroy-on-close":!0,"before-close":e.handleClose},on:{"update:visible":function(t){e.isShowEdit=t}}},[r("edit-page",{attrs:{procedure_id:e.procedure_id,detailDrawer:e.$refs.detailDrawer,changeCommit:e.changeCommit}})],1)],1)])},n=[],i=r("1bab"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{attrs:{id:"edit-base","label-width":"60px"}},[r("el-card",[r("el-form-item",{attrs:{label:"产品id"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.procedure.procedure_id,callback:function(t){e.$set(e.procedure,"procedure_id",t)},expression:"procedure.procedure_id"}})],1),r("el-form-item",{attrs:{label:"状态",prop:e.procedure.status,rules:{required:!0,message:"请填写工序状态",trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入工序状态",maxlength:"5","show-word-limit":""},model:{value:e.procedure.status,callback:function(t){e.$set(e.procedure,"status",t)},expression:"procedure.status"}})],1),r("el-form-item",{attrs:{label:"成本",rules:e.costRules}},[r("el-input-number",{attrs:{placeholder:"请输入成本",precision:2,controls:!1},model:{value:e.procedure.cost,callback:function(t){e.$set(e.procedure,"cost",t)},expression:"procedure.cost"}})],1),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入工序描述",maxlength:"45","show-word-limit":""},model:{value:e.procedure.comments,callback:function(t){e.$set(e.procedure,"comments",t)},expression:"procedure.comments"}})],1)],1),r("el-form-item",[r("el-button",{on:{click:e.cancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.commit}},[e._v("提交")])],1)],1)},a=[],s={name:"edit",props:["procedure_id","detailDrawer","changeCommit"],data:function(){var e=function(e,t,r){if(!t)return r(new Error("请填写成本"));t<=0?r(new Error("成本必须大于0")):r()};return{procedure:{},costRules:[{validator:e,trigger:"blur"}]}},methods:{getData:function(){var e=this;Object(i["a"])({url:"/process/getProcedureInfoByID",method:"get",params:{procedure_id:this.procedure_id}}).then((function(t){e.procedure=t.data})).catch((function(e){console.log(e)}))},commit:function(){var e=this;this.$confirm("是否提交本次修改？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["a"])({url:"/process/updateProcedureByID",method:"post",data:{procedure_id:e.procedure.procedure_id,status:e.procedure.status,comments:e.procedure.comments,cost:e.procedure.cost,operator_id:e.$store.getters.userinfo.id}}).then((function(t){console.log(t.data),"更新失败"!=t.data?(e.changeCommit(),e.detailDrawer.closeDrawer(),e.$message({type:"success",message:"修改成功"})):e.$message({type:"error",message:t.data})})).catch((function(t){e.$message({type:"error",message:"网络错误，修改失败"})}))}))},cancel:function(){this.detailDrawer.closeDrawer()}},created:function(){this.getData()}},u=s,l=(r("1f1b"),r("2877")),d=Object(l["a"])(u,c,a,!1,null,"0ccf10e6",null),p=d.exports,m={name:"List",data:function(){return{currentPage:1,size:5,isCommit:!1,count:0,procedures:[],procedure_id:"",isShowEdit:!1}},methods:{handleSizeChange:function(e){this.size=e,this.getProcedure(this.currentPage,e)},handleCurrentChange:function(e){this.currentPage=e,this.getProcedure(e,this.size)},getProcedure:function(e,t){var r=this;Object(i["a"])({url:"/process/getProceduresInfo",method:"get",params:{pageOffset:e,pageSize:t}}).then((function(e){r.count=e.data.count,r.procedures=e.data.procedures})).catch((function(e){console.log(e)}))},del:function(e,t){var r=this;this.$confirm("是否删除该工序？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["a"])({url:"/process/deleteProcedureByID",method:"post",data:{procedure_id:t.procedure_id,operator_id:"CM"}}).then((function(e){"删除成功"==e.data?(r.getProcedure(r.currentPage,r.size),r.$message({type:"success",message:"删除成功"})):r.$message({type:"error",message:e.data})})).catch((function(e){r.$message({type:"error",message:"网络错误，删除失败"})}))}))},showEdit:function(e){this.procedure_id=e.procedure_id,this.isShowEdit=!0},handleClose:function(e){this.isCommit?(this.getProcedure(this.currentPage,this.size),e()):this.$confirm("关闭后会丢失本次修改，是否关闭？").then((function(){e()})).catch((function(){})),this.isCommit=!1},changeCommit:function(){this.isCommit=!0}},components:{editPage:p},created:function(){this.getProcedure(this.currentPage,this.size)},activated:function(){this.getProcedure(this.currentPage,this.size)}},h=m,f=(r("0494"),Object(l["a"])(h,o,n,!1,null,"ea996a7e",null));t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-4f4154b0.0207796a.js.map